---
title: "AI 신호등 (1) 소개"
excerpt: "AI 신호등을 만들게 된 동기 및 개요"

categories:
  - Blog
tags:
  - Blog
---

지난 학기에 소프트웨어학과 친구들과 팀을 짜서 성균글로벌챌린저 프로그램에 참여하였다.
​

주제는 <b>"AI 신호등을 이용한 교통체증 감소"</b>였고,
카메라를 이용해 실시간으로 보행자와 차량의 수를 인식하고 대기수가 많은 곳부터 신호를 보내는 신호등을 계획하였다.​

다들 운전을 하다가 비효율적인 신호체계에 불만을 가진 적이 있을 것이다. 현재 신호등은 내장된 타이머로 동작되는데, 이 방식은 도로 상황을 반영하지 못하므로 대기 차량이 없는 도로에 초록불을 주고 대기 차량이 많은 도로에 빨간신호를 제공하게 되는 다소 비효율적인 신호 체계를 가질 때가 있다.
​
<b>나는 이러한 현재의 신호등에 불편함을 느꼈고, 인공지능을 통해 이를 해결할 수 있을거라 생각했다.</b>

그리고 마침 학교에서 글로벌챌린저를 모집하고 있길래, 금전적으로도 지원을 받고 스마트 신호등을 연구하는 해외 기업에 탐방을 가서 관련된 정보도 많이 얻고 조언을 얻으면 좋을 것 같다고 생각했다. (글로벌챌린저 프로그램은 지역사회 문제해결을 위해 해외 기업을 방문하고 자문을 얻는 그런 프로그램이다 ..)​
그래서 우리 팀은 열심히 도전계획서와 PPT, 그리고 여러 해외 기업에 컨택 메일을 보내면서 글로벌챌린저 준비를 했는데 ....... 본선에서 탈락하게 되었다........

아쉽게도 글로벌챌린저 프로그램에는 참여를 못했지만, 나는 누구보다 인공지능 신호등에 진심이었기에 ... 여름 방학 동안 혼자서 끙끙되며 인공지능 신호등을 제작했다. 그리고 최종적으로 라즈베리파이와 카메라를 이용해 실시간으로 신호를 제어하는 인공지능 신호등을 완성할 수 있었다.

그리고 나는 이 인공지능 신호등을 2차원 인공지능 신호등이라 이름지었다. 현재의 신호등을 1차원 방식이라치면, 이 인공지능 신호등은 한 단계 발전된 형태이기 때문에, <b>1차원 => 2차원...</b>이란 의미로 2차원 인공지능 신호등이라고 명명했다 ㅎ.. (그리고 뒤에 나오겠지만 또 다른 이유가 있다)


<br>

<hr color ="gray" size = "4px">

<br>


이젠 내가 만든 2차원 인공지능 신호등에 대해 소개해보도록 하겠다.
​
<b>큰 동작 방식은 아래와 같다.</b><br>
1) 카메라로 실시간 도로 상황을 영상으로 받아온다.<br>
2) 차와 보행자를 각각 인식한다.<br>
     (다음 포스팅에 설명하겠지만 인식 방법엔 차량과 보행자를 각각 인지하는 방법과 길이로 인식하는 방법 두 경우가 있다.)<br>
3) 대기자/대기차량이 많은 순대로 초록불 신호를 걸어준다.
​
매우 간단하다. 3번의 신호 체계 알고리즘을 설명해보자면...<br>
<b>큰 틀은 '대기자/대기차량이 많은 순대로 초록불 신호를 걸어주는 것'이다.<b><br>
하지만 이렇게 된다면 여러 문제가 생기게 된다. 처음에는 나도 위처럼 조건을 주면 되겠지하며 우습게 여겼지만 실제로 제작해보니 굉장히 많은 문제점들이 생겼다..

<h3>문제점 1</h3>  -----------------------------------------------------------------------------------------------------------
<img src="https://user-images.githubusercontent.com/75300099/102845069-111b3400-4450-11eb-94de-26969a64a862.png"><br>
위와 같은 상황을 보자. 서쪽으로부터 오는 차량의 수가 압도적으로 많으며,
다른 쪽에는 차량 수요가 많지 않는 상황이다. 이런 상황에는 남쪽의 차량이 자신의 신호를 받기 위해선 서쪽의 차량보다 자신의 차량이 더 많아지기를
하염없이 기다려야 하는 상황이 벌어진다. <del>그러다 남쪽의 운전자는 신호를 기다리다 하루를 보낼 수도 있으니...</del> 이를 예방하는 조건을 추가해야한다.

그래서 나는 <b>모든 대기자는 3분 이상 신호를 기다리면 안된다."</b>라는 것을 조건으로 추가하였다.
즉 남쪽의 운전자가 생긴 이상, 그 운전자가 3분을 기다리기 전에 꼭 남쪽의 통행 신호를 걸어주어야 하는 것이다.

<h3>문제점 2</h3>  -----------------------------------------------------------------------------------------------------------
<img src="https://user-images.githubusercontent.com/75300099/102845159-432c9600-4450-11eb-85e5-5d6b59f0c7f7.png"><br>
이제 남쪽 차량들은 해결이 되었다. 그런데 갑자기 동쪽으로부터 좌회전을 원하는 차량이 한 대 오게 되었다.
그렇다면 신호등은 어떤 신호를 출력해야할까? 앞의 조건이라면 서쪽의 대기차량이 많을테니 서쪽을 위한 신호를 출력해야한다.
하지만 그렇다면 곧 3분 후에 동쪽을 위해 신호를 바꿔야 하니, 이것은 굉장히 비효율적인 신호가 된다. (교통 수요가 많은 곳에 원활한 흐름을 부여하기 위해선 정지 신호를 최소화해야 한다.)
​

그래서 나는 다음과 같은 조건을 추가했다.
<b>신호를 부여할 땐 부여하지 않은 곳에 대기 차량이 있는지를 우선적으로 확인해야 한다.</b>
즉, 남쪽에 신호를 주고 다시 서쪽으로 가는 것이 아니라 동쪽과 북쪽에도 차량이 있는지를 확인해야 한다는 것이다.


<br>
<hr color ="gray" size = "4px">
<br>


내가 위에서 2차원 신호등의 이름에 다른 이유가 있다고 말했다.
그것은 바로... 내 머릿속에 3차원 신호등을 구상하고 있기 때문이다.
사실 난 지금 구현한 신호등은 굉장히 <b>부분적이고 일시적인 해결책</b>이라고 생각한다.
앞으로 몇 십년 후의 교통까지 책임질 수 있는 고도화되고 직접적인 해결책이 될 수 없다는 점이다.
따라서... 2차원 .... 조금 옛것으로 보이는 덜 발달된 것 같지만.... 그래도 옛날보다 조금은 발전되었다는 의미로 2차원 신호등이라고 이름을 지었다.
​
일단 위의 신호등은 한 구역에만 설치할 수 있고, 한 구역의 신호만 다룰 수 있다.
즉, 모든 신호를 원활하게 하려면 전국에 카메라를 설치해야 한다. 따라서 굉장히 부분적인 해결책이라고 말할 수 있으며,
큰 도로에서는 별 소용이 없어진다. 왜냐하면 차량 수요가 많은 큰 도로는 전체적으로 묶여 차례대로 연관되어 움직이는 형태인데,
큰 도로의 한 부분에만 설치하면 전체적으로 아무런 이득을 가져오지 못하기 때문이다. 따라서 위의 2차원 신호등은,
<b>큰 도로의 흐름에 영향을 받지 않는 작은 도로나 동네 사거리에만 적용할 때 큰 이득을 불러온다.</b>
​

또한, 굉장히 일시적인 해결책이다. 몇 년 후에는 커넥티비티 차량이 대부분일텐데, 그 특성을 활용하지 못하고
일차원적으로 카메라 영상으로 각각의 차량와 보행자를 인식한다는 것이.... 과연 몇 십년 후까지 사용될만한 기술인지는 모르겠다.
​

따라서 나는... 현재의 신호등을 넘어서 더 발전된 형태의 신호등을 제작하고 싶다.
내가 계획하고 있는 3차원 인공지능 신호등은 모든 차량의 목적지를 입력받고, 그들에게 가장 최적의 길을 제공하고 
그들이 목적지로 멈추지 않고 갈 수 있도록 전국의 신호체계를 제어하는 ... 그런 신호등이다. 말하고 보니까 3차원이 아니라
4차원 신호등이라고 불러도 되지 않을까 싶지만 .... 


그리고 이것을 위해 현재 강화학습에 관해 공부하고 있다. 강화학습이란 행동에 대한 "보상"을 받는 형태로 학습을 하는 머신러닝인데,
위의 인공지능 교통체계를 만들고 학습시키기 위해선 강화학습이 적격이라고 생각했다. 왜냐하면 차량의 대기 시간 등을 판단 요소로 정의하고
어떨 때 어떤 신호를 부여하는 것이 가장 이득인지를 판단하고 과거의 경험으로 이득을 이끌 수 있기 때문이다.

하지만 강화학습에도 한계점이 있다. 사실 강화학습의 문제가 아니라 인공지능의 한계점인데, <b>Catastrophic Forgetting</b>이라고
학습을 과정에서 새로운 학습 데이터로 기존의 판단들이 잊혀지거나 오염될 수 있다는 점이다. 예를 들어서 원래는 승용차만 다닐 수 있는 도로인데
갑자기 버스나 트럭과 같은 상용차까지 다닐 수 있게 되었다고 하자. 그럼 인공지능의 알고리즘은 버스와 트럭을 학습하려고 할 것인데, 이때
기존의 알고리즘에 영향을 미치게 되어 승용차의 인식 성능이 떨어지게 될 것이다. 이처럼 새로운 과제로 인해 기존의 과제가 망각이 되는 것을 Catastrophic Forgetting이라고
하며 이는 현재 인공지능이 가지는 큰 한계이다. 그렇다고 해서 새로운 데이터의 학습을 거부하는 것은 더더욱 문제이다.
<b>따라서 현재 들어오는 데이터를 학습하면서도 기존 학습에 대한 성능을 잃지 않는 것이 중요한 것인데, 이를 위해
요즘 연속학습이 연구되고 있다고 한다.</b> 연속학습은 <b>Continual learning</b>이라고 하는 것으로, 기존의 과제에서 추가로 다른 과제가 들어와도
기존의 과제 성능에 영향을 끼치지 않는 방식을 고안하고 있다.

연속학습에 대한 연구가 필수적이어야 하는 것이, 실생활 문제에 인공지능을 적용시키기 위해서 인공지능이 해결해야 하는 점이기 때문이다.
현재 인공지능은 제한적인 상황에서만 적용되며, 학습을 위한 정해진 데이터들이 존재해야만 한다. 이렇기에 <b>유연한 실생활 문제를 다루기엔 한계가 존재한다.</b>
하지만 위에 예를 든 것처럼 실생활에는 여러가지 변수가 존재하며, 시간이 지남에 따라 업데이트 되는 것들이 존재한다. 따라서 유연한 실생활 문제를 모두
해결하고 수용하되 기존의 학습에 대한 성능을 잃지 않는 방향으로 인공지능은 발달이 되어야 하며, 연속학습이 바로 이것을 해결해 줄 수 있을거라고 생각한다.
과거의 학습 모델을 잊지 않고서도 현재의 상황에 대한 피드백을 가지는.. 그런 인공지능 모델을 만들어야만 실생활의 편리함을 이끌 수 있을 것이며,
내가 구현하고자 하는 인공지능 신호등, 교통체계 또한 이를 필수적으로 구현해야만 해결할 수 있는 문제라고 생각한다.